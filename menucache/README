###############################################
MenuCache
Pre 0.1 proof of concept
###############################################

Developer
-----------------------------------------------
Nicolaas Francken [at] sunnysideup.co.nz

Requirements
-----------------------------------------------
SilverStripe 2.3.0 or greater.

Documentation
-----------------------------------------------
This module allows you to cache the menu, which
can put a big straing on your database.

The first time a page is loaded, it will run the standard menu,
after that, it will retrieve the menu as one big chunk of html.

NOTE: this does not work if you expect the menu to change with
added actions (e.g. http://www.mysite.com/mypage/myaction/)


Installation Instructions
-----------------------------------------------
1. Find out how to add modules to SS and add module as per usual.
2. copy configurations from this module's _config.php file
into mysite/_config.php file and edit settings as required.
NB. the idea is not to edit the module, but instead customise it
in your mysite folder at all so that you can upgrade it later.
3. copy the template syntax from your menu and copy it to
/themes/mytheme/templates/Includes/CachedMenu.ss
4. replace <% include MyNonCachedMenuFile %> in your template with
$CachedMenu (NOTE: dont use $MenuCache)


example htaccess file (NOTE .php as the extension)
-----------------------------------------------
### SILVERSTRIPE START ###
# Cached content -
RewriteCond %{REQUEST_METHOD} ^GET$
RewriteCond %{QUERY_STRING} ^$
RewriteCond %{REQUEST_URI} ^/(.*)$
RewriteCond %{REQUEST_URI} /(.*[^/])/?$
RewriteCond %{DOCUMENT_ROOT}/cache/%1.php -f
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule .* /cache/%1.php [L]

# Cached content - homepage
RewriteCond %{REQUEST_METHOD} ^GET$
RewriteCond %{QUERY_STRING} ^$
RewriteCond %{REQUEST_URI} ^/?$
RewriteCond /cache/index.php -f
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule .* /cache/index.php [L]

# Dynamic content
RewriteCond %{REQUEST_URI} !(\.gif)|(\.jpg)|(\.png)|(\.css)|(\.js)|(\.php)$
RewriteCond %{REQUEST_URI} ^(.*)$
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule .* /sapphire/main.php?url=%1&%{QUERY_STRING} [L]
### SILVERSTRIPE END ###
